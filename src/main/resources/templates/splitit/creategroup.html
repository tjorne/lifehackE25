<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Create Group - SPLITit</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/splitit/splitit.css}"/>
</head>
<body>
<header>
    <nav>
        <a th:href="@{/}">
            <img th:src="@{/images/splitit/logo.svg}" alt="Split it logo">
        </a>
    </nav>
</header>

<main>
    <div class="title">
        <h1>SPLITit</h1>
        <hr class="divider">
        <h3>Your expense splitter</h3>
    </div>

    <div class="selector">
        <h2>Create a group</h2>

        <!-- Group Name Input (only show if not set yet) -->
        <form th:action="@{/createGroup/setName}" method="post" th:if="${groupName == null}">
            <input type="text" name="groupName" placeholder="Group name" required>
            <button type="submit">ADD</button>
        </form>

        <!-- Show group name once set -->
        <p th:if="${groupName != null}">
            <strong>Group:</strong> <span th:text="${groupName}">Group Name</span>
        </p>

        <!-- Add Members Form (only show after name is set) -->
        <div th:if="${groupName != null}">
            <form th:action="@{/createGroup/addMember}" method="post">
                <select name="userId" id="userSelect" required>
                    <option value="" disabled selected>Choose groupmember from list</option>
                    <option th:each="user : ${availableUsers}"
                            th:value="${user.userId}"
                            th:text="${user.userName}">
                        User Name
                    </option>
                </select>
                <button type="submit">ADD</button>
            </form>

            <hr class="divider">

            <!-- Display Added Members -->
            <div class="member-list" th:if="${addedMembers != null and !addedMembers.empty}">
                <div class="member-item" th:each="member : ${addedMembers}">
                    <h4 th:text="${member.userName}">Name</h4>
                    <form th:action="@{/createGroup/removeMember}" method="post" style="display: inline;">
                        <input type="hidden" name="userId" th:value="${member.userId}">
                        <button type="submit" class="btn-delete">
                            <img th:src="@{/images/splitit/bucket.svg}" alt="Delete member" class="delete-icon">
                        </button>
                    </form>
                </div>
            </div>

            <!-- Empty state -->
            <p th:if="${addedMembers == null or addedMembers.empty}">
                No members added yet.
            </p>

            <!-- Final Create Button -->
            <form th:action="@{/createGroup/create}" method="post">
                <button type="submit" class="btn-primary"
                        th:disabled="${addedMembers == null or addedMembers.empty}">
                    CREATE
                </button>
            </form>
        </div>
    </div>
    <!-- Cancel/Reset  Make this as a link, not a button! -->
    <a th:href="@{/createGroup/cancel}">Cancel</a>
</main>

<footer>
    <div>
        <p>
            <a href="https://github.com/Mortenjenne" target="_blank" rel="noopener">
                <img th:src="@{/images/splitit/github-icon.svg}" alt="Github icon"> MORTEN JENSEN
            </a>
        </p>
        <p>
            <a href="https://github.com/DHangaard" target="_blank" rel="noopener">
                <img th:src="@{/images/splitit/github-icon.svg}" alt="Github icon"> DANIEL HANGAARD
            </a>
        </p>
    </div>
</footer>
</body>
</html>